<h1 id="manejo-de-numeros-complejos-en-python">Manejo de numeros complejos en python</h1>

<p>Recordemos que cuando queremos resolver ciertas ecuaciónes tales como
\(x^2 + 1=0\)
estas no tienen solución.</p>

<p>Para esto en matematicas se introducen los números complejos que son numeros de la forma
\(z=x+ i y\)</p>

<p>Python trae por defecto una forma de utilizar estos numeros complejos. Veamos esto en codigo para entender su introducción.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">###### Para python la unidad imaginaria "i" se escribe como "1j"
</span><span class="n">unidad_imaginaria</span> <span class="o">=</span> <span class="mf">1j</span>
<span class="c1"># Luego, podemos inicializar un numero complejo de 2 maneras
</span>
<span class="c1"># Manera EXPLICITA : z=a+bj 
</span><span class="n">c_1</span> <span class="o">=</span> <span class="mi">3</span><span class="o">+</span><span class="mf">5j</span>
<span class="c1"># Manera IMPLICITA : z=(x,y)
</span><span class="n">c_2</span> <span class="o">=</span> <span class="nf">complex</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Variable   </span><span class="se">\t</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">Tipo de Dato</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">--------------------|----------------------</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">c_1</span><span class="si">}</span><span class="s">      </span><span class="se">\t</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span>  <span class="nf">type</span><span class="p">(</span><span class="n">c_1</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">c_2</span><span class="si">}</span><span class="s">      </span><span class="se">\t</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span>  <span class="nf">type</span><span class="p">(</span><span class="n">c_2</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>Variable   	    |   Tipo de Dato
--------------------|----------------------
(3+5j)      	    |   &lt;class 'complex'&gt;
(3+5j)      	    |   &lt;class 'complex'&gt;
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="c1"># Con respecto a las operaciones. Python se encarga de identificar si es o no complejo
</span><span class="n">c_3</span> <span class="o">=</span> <span class="n">unidad_imaginaria</span> <span class="o">+</span> <span class="n">c_1</span>
<span class="n">c_4</span> <span class="o">=</span> <span class="n">unidad_imaginaria</span> <span class="o">-</span> <span class="n">c_1</span>
<span class="n">c_5</span> <span class="o">=</span> <span class="n">unidad_imaginaria</span> <span class="o">*</span> <span class="n">c_1</span>
<span class="n">c_6</span> <span class="o">=</span> <span class="n">unidad_imaginaria</span> <span class="o">/</span> <span class="n">c_1</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Variable   </span><span class="se">\t</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">Operacion </span><span class="se">\t</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Resultado</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">--------------------|----------------------|-----------------</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">c_3      </span><span class="se">\t</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">unidad_imaginaria</span><span class="si">}</span><span class="s">+ </span><span class="si">{</span><span class="n">c_1</span><span class="si">}</span><span class="s"> </span><span class="se">\t</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span> <span class="n">c_3</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">c_4      </span><span class="se">\t</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">unidad_imaginaria</span><span class="si">}</span><span class="s"> - </span><span class="si">{</span><span class="n">c_1</span><span class="si">}</span><span class="s"> </span><span class="se">\t</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span> <span class="n">c_4</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">c_5      </span><span class="se">\t</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">unidad_imaginaria</span><span class="si">}</span><span class="s"> * </span><span class="si">{</span><span class="n">c_1</span><span class="si">}</span><span class="s"> </span><span class="se">\t</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span> <span class="n">c_5</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">c_6      </span><span class="se">\t</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">unidad_imaginaria</span><span class="si">}</span><span class="s"> / </span><span class="si">{</span><span class="n">c_1</span><span class="si">}</span><span class="s"> </span><span class="se">\t</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span><span class="sh">"</span><span class="s">|</span><span class="sh">"</span> <span class="p">,</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span> <span class="p">,</span> <span class="n">c_6</span><span class="p">)</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>Variable   	    |   Operacion 	   |   Resultado
--------------------|----------------------|-----------------
c_3      	    |   1j+ (3+5j) 	   |   (3+6j)
c_4      	    |   1j - (3+5j) 	   |   (-3-4j)
c_5      	    |   1j * (3+5j) 	   |   (-5+3j)
c_6      	    |   1j / (3+5j) 	   |   (0.14705882352941177+0.08823529411764706j)
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c1"># Para tomar la parte real, existe el atributo real
</span><span class="nf">print</span><span class="p">(</span><span class="n">c_1</span><span class="p">.</span><span class="n">real</span><span class="p">)</span>
<span class="c1"># Para tomar la parte imaginaria, existe el atributo imag
</span><span class="nf">print</span><span class="p">(</span><span class="n">c_1</span><span class="p">.</span><span class="n">imag</span><span class="p">)</span>
<span class="c1"># Podemos tomar el conjudago de un numero con el metodo conjugate()
</span><span class="nf">print</span><span class="p">(</span><span class="n">c_1</span><span class="p">.</span><span class="nf">conjugate</span><span class="p">())</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>3.0
5.0
(3-5j)
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Se puede realizar un cambio de coordenadas.</p>

<p>Recordemos que se puede identificar un numero complejo como un punto del plano complejo, donde se toma el eje imaginario como el eje de ordenadas, y al eje real como el de absisas. Ademas, podemos expresar al numero complejo en sus coordenadas polares, la cual es mas util para poder representar los numeros complejos en un eje de coordenadas.</p>

<p>Para hacer un paso de coordenadas de rectangulares a polares utilizaremos la libreria <a href="https://docs.python.org/3/library/cmath.html">cmath</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">cmath</span> <span class="k">as</span> <span class="n">cm</span>

<span class="n">z1</span> <span class="o">=</span> <span class="mi">3</span><span class="o">+</span><span class="mf">5j</span> <span class="c1"># Esta en cartesianas
</span>
<span class="c1"># Utilizo la funcion *polar* de cmath para convertir a polares
</span><span class="n">z1_polar</span> <span class="o">=</span> <span class="n">cm</span><span class="p">.</span><span class="nf">polar</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span> 

<span class="c1"># Ahora, para tomar la tupla de coordenadas polares y convertirlo a numero complejo 
# utilizamos la función *rect* de cmath
</span><span class="n">z1_comp</span> <span class="o">=</span> <span class="n">cm</span><span class="p">.</span><span class="nf">rect</span><span class="p">(</span><span class="n">z1_polar</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z1_polar</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>


<span class="nf">print</span><span class="p">(</span><span class="nf">type</span><span class="p">(</span><span class="n">z1_polar</span><span class="p">))</span> <span class="c1"># Nos debe devolver que es una tupla
</span><span class="nf">print</span><span class="p">(</span><span class="n">z1_polar</span><span class="p">)</span>       <span class="c1"># (modulo, angulo en radianes)
</span><span class="nf">print</span><span class="p">(</span><span class="nf">type</span><span class="p">(</span><span class="n">z1_comp</span><span class="p">))</span>  <span class="c1"># vuelve a ser complejo
</span><span class="nf">print</span><span class="p">(</span><span class="n">z1_comp</span><span class="p">)</span>        <span class="c1"># Vuelvo a cartesianas
</span></pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>&lt;class 'tuple'&gt;
(5.830951894845301, 1.0303768265243125)
&lt;class 'complex'&gt;
(3+5j)
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Imaginemos que estamos trabajando con numpy y no queremos cargar mas librerias.</p>

<p>Podemos hacer este cambio de coordenadas de la siguiente forma</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">z1_modulo</span><span class="p">,</span> <span class="n">z1_angulo</span> <span class="o">=</span> <span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">z1</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">angle</span><span class="p">(</span><span class="n">z1</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Coordenadas polares del complejo </span><span class="se">\n\n</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Modulo de z1: </span><span class="si">{</span><span class="n">z1_modulo</span><span class="si">}</span><span class="s"> </span><span class="se">\n</span><span class="s">Angulo del complejo: </span><span class="si">{</span><span class="n">z1_angulo</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">¿Son iguales los valores obtenidos para ambas representaciónes?</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">--&gt; Modulo de z1: </span><span class="si">{</span><span class="n">z1_polar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">z1_modulo</span><span class="si">}</span><span class="s"> </span><span class="se">\n</span><span class="s">--&gt; Angulo del complejo: </span><span class="si">{</span><span class="n">z1_polar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">z1_angulo</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>Coordenadas polares del complejo 


Modulo de z1: 5.830951894845301 
Angulo del complejo: 1.0303768265243125

¿Son iguales los valores obtenidos para ambas representaciónes?
--&gt; Modulo de z1: True 
--&gt; Angulo del complejo: True
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Una versatilidad que tiene trabajar con numpy es el hecho de que podemos pedirle que los pase el angulo a grados. Por defecto, este lo pasa en radianes, sin embargo podemos pasarle el atributo <em>deg=True</em> al metodo angle de numpy.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">z1_rad</span> <span class="o">=</span> <span class="n">z1_angulo</span>
<span class="n">z1_deg</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">angle</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">En radianes: </span><span class="si">{</span><span class="n">z1_rad</span><span class="si">}</span><span class="s"> </span><span class="se">\n\n</span><span class="s">En grados: </span><span class="si">{</span><span class="n">z1_deg</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>En radianes: 1.0303768265243125 

En grados: 59.03624346792648
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Ahora, recordando que
\(z_1 = a+i b = |z_1|e^{i \theta}\)
Podemos utilizar el numero de Euler definido en numpy para poder hacer el pase de coordenadas polares a la forma binomica</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">z1_binomica</span> <span class="o">=</span> <span class="n">z1_modulo</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">e</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1j</span> <span class="o">*</span> <span class="n">z1_rad</span><span class="p">))</span> <span class="c1"># Debe estar en radianes
</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">La forma binomica es: </span><span class="si">{</span><span class="n">z1_binomica</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>La forma binomica es: (3+5j)
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">def</span> <span class="nf">move_spines</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">Crea la figura de pyplot y los ejes.
       Mueve las lineas de la izquierda y de abajo
       para que se itersecten con el origen. 
       Elimina las lineas de la derecha y de arriba
       Devuelve los ejes</span><span class="sh">"""</span>
    
    <span class="n">fix</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="sh">"</span><span class="s">left</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">bottom</span><span class="sh">"</span><span class="p">]:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">].</span><span class="nf">set_position</span><span class="p">(</span><span class="sh">"</span><span class="s">zero</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="sh">"</span><span class="s">right</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">top</span><span class="sh">"</span><span class="p">]:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">].</span><span class="nf">set_color</span><span class="p">(</span><span class="sh">"</span><span class="s">none</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ax</span>

<span class="c1"># Defino un numero Complejo
</span><span class="n">z</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span> <span class="mf">4j</span>

<span class="c1"># LLamamos a la funcion
</span><span class="n">ax</span> <span class="o">=</span> <span class="nf">move_spines</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">z</span><span class="p">.</span><span class="n">real</span><span class="p">,</span><span class="n">z</span><span class="p">.</span><span class="n">imag</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">Grafico del punto en el plano complejo</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/assets/images/2023-01-17/output_14_0.png" alt="png" /></p>

<p>Los numeros complejos nos permiten graficar <a href="es.wikipedia.org/wiki/Fractal">fractales</a>. Veamos un ejemplo para graficar conjuntos de <a href="es.wikipedia.org/wiki/Gaston_Julia">Julia</a>.</p>

<p>Para esto implementaremos un programa con <a href="https://numpy.org/">numpy</a> y <a href="https://numba.pydata.org/">numba</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numba</span>

<span class="k">def</span> <span class="nf">py_julia_fractal</span><span class="p">(</span><span class="n">z_re</span><span class="p">,</span> <span class="n">z_im</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Crea el grafico del fractal de Julia.</span><span class="sh">"""</span>
    
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">z_re</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">z_im</span><span class="p">)):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">z_re</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1j</span> <span class="o">*</span> <span class="n">z_im</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.05</span> <span class="o">+</span> <span class="mf">0.68j</span>
                <span class="k">if</span> <span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">2.0</span><span class="p">:</span>
                    <span class="n">j</span><span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
                    <span class="k">break</span>

<span class="n">jit_julia_fractal</span> <span class="o">=</span> <span class="n">numba</span><span class="p">.</span><span class="nf">jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="bp">True</span><span class="p">)(</span><span class="n">py_julia_fractal</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">z_real</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">z_imag</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<span class="nf">jit_julia_fractal</span><span class="p">(</span><span class="n">z_real</span><span class="p">,</span> <span class="n">z_imag</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">RdBu_r</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">$\mathrm{Re}(z)$</span><span class="sh">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">$\mathrm{Im}(z)$</span><span class="sh">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>Text(0, 0.5, '$\\mathrm{Im}(z)$')
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/assets/images/2023-01-17/output_16_1.png" alt="png" /></p>

<p>Otro ejemplo de fractal es el conjunto de Malderbrot</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">mandelbrot</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">maxit</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Crea el grafico Fractal de Mandelbrot del tamaño (h,w)</span><span class="sh">"""</span>
    
    <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">ogrid</span><span class="p">[</span><span class="o">-</span><span class="mf">1.4</span><span class="p">:</span><span class="mf">1.4</span><span class="p">:</span><span class="n">h</span><span class="o">*</span><span class="mf">1j</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mf">0.8</span><span class="p">:</span><span class="n">w</span><span class="o">*</span><span class="mf">1j</span><span class="p">]</span>
    
    <span class="n">c</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="mf">1j</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">c</span>
    
    <span class="n">divtime</span> <span class="o">=</span> <span class="n">maxit</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">z</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">maxit</span><span class="p">):</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span>
        
        <span class="n">diverge</span> <span class="o">=</span> <span class="n">z</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">conj</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">div_now</span> <span class="o">=</span> <span class="n">diverge</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">divtime</span><span class="o">==</span><span class="n">maxit</span><span class="p">)</span>
        
        <span class="n">divtime</span><span class="p">[</span><span class="n">div_now</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        
        <span class="n">z</span><span class="p">[</span><span class="n">diverge</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    
    <span class="k">return</span> <span class="n">divtime</span>
    
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="nf">mandelbrot</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/assets/images/2023-01-17/output_18_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>
</pre></td></tr></tbody></table></code></pre></div></div>
